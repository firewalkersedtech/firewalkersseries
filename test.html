<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Exam Interface</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .palette-drawer { transition: transform 0.3s ease; }
        .palette-drawer.open { transform: translateX(0); }
        .opt-radio:checked + div { background-color: #eff6ff; border-color: #3b82f6; }
    </style>
</head>
<body class="bg-gray-100 h-screen flex flex-col select-none overflow-hidden">

    <header class="bg-white border-b h-14 flex justify-between items-center px-3 shrink-0">
        <div class="font-bold text-[#0B1120]">FIRE<span class="text-[#D4AF37]">WALKERS</span></div>
        <div class="flex items-center gap-3">
            <div class="bg-gray-100 px-2 py-1 rounded text-sm font-bold border">
                Time Left: <span id="timer" class="text-red-600">60:00</span>
            </div>
            <button onclick="togglePalette()" class="md:hidden text-[#0B1120]"><i class="fa-solid fa-grid-2 text-xl"></i></button>
        </div>
    </header>

    <div class="bg-[#0B1120] text-white flex overflow-x-auto whitespace-nowrap shrink-0 no-scrollbar" id="sections">
        </div>

    <div class="flex-1 flex relative overflow-hidden">
        <main class="flex-1 flex flex-col h-full overflow-y-auto bg-white p-4 pb-24">
            
            <div class="flex justify-between items-center border-b pb-2 mb-4 sticky top-0 bg-white z-10">
                <div class="flex gap-2 items-center">
                    <span class="font-bold text-red-600">Q.<span id="q-num">1</span></span>
                    <span class="text-xs text-gray-400" id="q-time">⏱️ 0s</span>
                </div>
                <div class="text-[10px] font-bold flex gap-2">
                    <span class="text-green-600 bg-green-50 px-1 rounded">+2.0</span>
                    <span class="text-red-600 bg-red-50 px-1 rounded">-0.5</span>
                </div>
            </div>

            <div id="q-content" class="mb-6 text-sm font-medium">
                </div>

            <div id="options" class="space-y-3">
                </div>
        </main>

        <aside id="palette" class="palette-drawer fixed inset-y-0 right-0 w-3/4 max-w-xs bg-white border-l z-50 transform translate-x-full md:relative md:translate-x-0 md:w-80 flex flex-col">
            <div class="p-3 bg-gray-100 border-b flex justify-between">
                <span class="font-bold text-sm">Overview</span>
                <button onclick="togglePalette()" class="md:hidden"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="p-2 grid grid-cols-2 gap-2 text-[10px] border-b">
                <div class="flex items-center gap-1"><span class="w-3 h-3 bg-green-500 rounded-full"></span> Answered</div>
                <div class="flex items-center gap-1"><span class="w-3 h-3 bg-red-500 rounded-full"></span> Not Answered</div>
                <div class="flex items-center gap-1"><span class="w-3 h-3 bg-gray-200 border rounded-full"></span> Not Visited</div>
            </div>
            <div class="flex-1 overflow-y-auto p-3">
                <div class="grid grid-cols-5 gap-2" id="grid"></div>
            </div>
            <div class="p-3 border-t">
                <button onclick="submitTest()" class="w-full bg-[#0B1120] text-white py-2 rounded font-bold">SUBMIT</button>
            </div>
        </aside>
    </div>

    <footer class="bg-white border-t p-2 flex justify-between fixed bottom-0 w-full z-40 md:static">
        <button onclick="clearRes()" class="px-4 py-2 border border-red-500 text-red-500 rounded text-sm font-bold">Clear</button>
        <button onclick="saveNext()" class="px-8 py-2 bg-green-600 text-white rounded text-sm font-bold shadow">Save & Next</button>
    </footer>

    <script>
        // --- DATA & STATE ---
        const sections = ['Reasoning', 'GK', 'Quant', 'English'];
        let currSec = 0;
        let currQ = 0;
        let time = 3600; // 60 mins
        
        // Mock 100 Questions
        const data = sections.map(s => Array.from({length: 25}, (_, i) => ({
            id: i+1, 
            text: `Sample Question ${i+1} for ${s}`,
            status: 'not-visited', // not-visited, not-answered (red), answered (green)
            marked: null,
            timeSpent: 0
        })));

        // --- INIT ---
        function init() {
            renderTabs();
            loadQuestion();
            renderPalette();
            setInterval(tick, 1000);
        }

        // --- RENDER FUNCTIONS ---
        function renderTabs() {
            const container = document.getElementById('sections');
            container.innerHTML = sections.map((s, i) => `
                <button onclick="changeSec(${i})" class="px-4 py-3 text-sm font-medium ${i===currSec ? 'bg-white text-blue-600 border-t-2 border-blue-600' : 'opacity-70 hover:opacity-100'}">
                    ${s}
                </button>
            `).join('');
        }

        function loadQuestion() {
            const q = data[currSec][currQ];
            document.getElementById('q-num').innerText = q.id;
            document.getElementById('q-content').innerText = q.text;
            document.getElementById('q-time').innerText = `⏱️ ${q.timeSpent}s`;
            
            // Render Options
            const opts = document.getElementById('options');
            opts.innerHTML = ['A', 'B', 'C', 'D'].map(opt => `
                <label class="cursor-pointer block">
                    <input type="radio" name="opt" class="hidden opt-radio" value="${opt}" ${q.marked === opt ? 'checked' : ''}>
                    <div class="flex items-center p-3 rounded border hover:bg-gray-50">
                        <span class="w-6 h-6 rounded-full border mr-3 flex items-center justify-center text-xs font-bold">${opt}</span>
                        <span>Option Text ${opt}</span>
                    </div>
                </label>
            `).join('');

            // If visiting for first time, mark as Not Answered (Red) unless already Answered (Green)
            if(q.status === 'not-visited') {
                q.status = 'not-answered';
                renderPalette();
            }
        }

        function renderPalette() {
            const grid = document.getElementById('grid');
            grid.innerHTML = data[currSec].map((q, i) => {
                let color = 'bg-gray-200 text-gray-600'; // Default
                if (q.status === 'answered') color = 'bg-green-500 text-white';
                else if (q.status === 'not-answered') color = 'bg-red-500 text-white';
                
                let border = i === currQ ? 'border-2 border-black' : '';
                
                return `<div onclick="jumpTo(${i})" class="h-8 w-8 rounded flex items-center justify-center text-xs font-bold cursor-pointer ${color} ${border}">${q.id}</div>`;
            }).join('');
        }

        // --- ACTIONS ---
        function saveNext() {
            const selected = document.querySelector('input[name="opt"]:checked');
            const q = data[currSec][currQ];
            
            if (selected) {
                q.status = 'answered'; // Green
                q.marked = selected.value;
            } else {
                q.status = 'not-answered'; // Red if skipped
            }

            if (currQ < 24) currQ++;
            loadQuestion();
            renderPalette();
        }

        function clearRes() {
            const q = data[currSec][currQ];
            q.marked = null;
            q.status = 'not-answered';
            document.querySelectorAll('input').forEach(i => i.checked = false);
            renderPalette();
        }

        function changeSec(i) {
            currSec = i;
            currQ = 0;
            renderTabs();
            loadQuestion();
            renderPalette();
        }

        function jumpTo(i) {
            currQ = i;
            loadQuestion();
            renderPalette();
        }

        function tick() {
            if (time > 0) {
                time--;
                data[currSec][currQ].timeSpent++;
                document.getElementById('q-time').innerText = `⏱️ ${data[currSec][currQ].timeSpent}s`;
                
                let m = Math.floor(time / 60).toString().padStart(2, '0');
                let s = (time % 60).toString().padStart(2, '0');
                document.getElementById('timer').innerText = `${m}:${s}`;
            }
        }

        function togglePalette() {
            document.getElementById('palette').classList.toggle('translate-x-full');
        }

        function submitTest() {
            localStorage.setItem('testData', JSON.stringify(data));
            window.location.href = 'analysis.html';
        }

        init();
    </script>
</body>
</html>
